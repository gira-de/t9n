# Svelte Typesafe Internationalization

> A tiny Node.js based CLI that provides some tools to improve all things around i18n and a Svelte Store to enable typesafe internationalization.

## What is this for?

This lib is designed to support developers as well as translators and make their life easier. It:

- 📖 Makes translation keys type safe.
- 🚨 Shows devs and other stakeholders if translations are missing.
- 👜 Makes it easy to create a list of all used translation keys and extract something translation agencies can work with (xlsx ftw 👍).
- 🛬 Allows seemless imports of new translations.

### The Workflow

Everything in this lib is built around the following workflow. Sure, use it however you like, but this was in our mind when we created it.

1. Install this package ➡️ [Installation](##Installation)
2. Put all translation keys in the file (_meta.json_) and run `t9n typedefs <filename>` whenever it changes ➡️ [CLI Docs](/docs/cli.md)
3. Once the translations is created, run `t9n export <folderpath>` to create a xlsx-sheet for all translation keys. ➡️ [CLI Docs](/docs/cli.md)
4. Once the translation is done, import the translated xlsx with `t9n import <filename>` to create json files for every defined language. ➡️ [CLI Docs](/docs/cli.md)
5. To use these new translations adjust your config, if neccessary. ➡️ [Store Docs](/docs/store.md)

## Installation

### Authentication

This package is shared in a private GIRA npm registry. If you have never used the GIRA registry before, you first have to login to generate an access token:

```shell
npm login --scope=@gira --registry=https://nexus.ise.de/repository/npm-gira/
```

If you get an authentication error, you must first apply for the appropriate access rights.

### Package installation

When t9n is used in a package.

```shell
# using npm
npm install @gira/t9n-svelte -D

# or using yarn
yarn add @gira/t9n-svelte -D
```

You should be able to use the command line tool via npx:

```shell
npx t9n
```

### Global installation

Useful if only the command line interface is used.

```shell
# using npm
npm install @gira/t9n-svelte -D -g

# or using yarn
yarn add @gira/t9n-svelte -D -g
```

Then run:

```shell
t9n
```

## Usage

Now you need to create some files and put everything together. Here is an example (final) folder structure:

```
.
└── your repository/
    ├── src/
    │   ├── t9n.ts
    │   └── locale-types.ts (<-- generated by t9n cli)
    └── locale/
        ├── meta.json
        └── en.json (<-- generated by t9n cli)
```

1. Create a file called _./locale/meta.json_. This json describes the structure of the actual language files. Every possible translation key needs to be described here.

```json
{
  "pageOne": {
    "headline": "This is a fancy headline written by a developer. Don't trust this! 🦹‍♀️🦹‍♂️"
  }
}
```

2. Create a file called _./locale/<language-key>.json_ (for example de.json). This is the actual language file.

```json
{
  "pageOne": {
    "headline": "Das ist die Überschrift von einem echten Übersetzer. Echt. 👩‍🏫👨‍🏫"
  }
}
```

3. Call the CLI to generate a type definition based on the language files. This command will generate a Typescript declaration file:

```shell
npx t9n typedefs ./meta.json -o locale-types.ts
```

4. Initialize a t9n instance that puts everything together:

```typescript
import de from '../locale/de.json';
import meta from '../locale/meta.json';
import type { TranslationArgs } from './locale-types';

const fallbackLanguage = {
  locale: 'meta',
  name: 'Developer',
  dictionary: meta,
} as const;

const languages = [
  fallbackLanguage,
  {
    locale: 'de',
    name: 'German',
    dictionary: de,
  }
] as const;

const t9n = newT9n<TranslationArgs>()({
  languages,
  fallbackLanguage,
  (translationKey, currentLanguage) => console.log('A translation key uses the fallback!'),
  (translationKey, currentLanguage) => console.log('A translation key is missing.'),
});

export const t = t9n.t;
export const $t = t9n.$t;
export const ti = t9n.ti;
export const $ti = t9n.$ti;
```

5. Use t9n:

```typescript
import { t, ti } from '../locale';

// Returns the translated string
$t(['pageOne.headline']);

// Returns an object with information regarding which directory the translation key was found and the actual text
$ti(['pageOne.headline']);
```

See an example T-Component that uses `$ti` to print and style translations: [Create a T component](/docs/store.md##Create-a-T-component)

## Further documentation

[Command Line Interface](./docs/cli.md)

[Svelte Store](./docs/store.md)

## Contributing

Contributions are always welcome!
